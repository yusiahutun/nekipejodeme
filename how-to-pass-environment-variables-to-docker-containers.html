<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="SnapBlog"><meta property="og:type" content="article"><meta name=robots content="index,follow,noarchive"><meta property="og:image" content="//img/home-bg-jeep.jpg"><meta property="twitter:image" content="//img/home-bg-jeep.jpg"><meta name=title content="How to Pass Environment Variables to Docker Containers"><meta property="og:title" content="How to Pass Environment Variables to Docker Containers"><meta property="twitter:title" content="How to Pass Environment Variables to Docker Containers"><meta name=description content="Programs often control operation through configuration bundled with the software, and environment variables allow users to set them at runtime. However, running processes in Docker containers complicates things, so how do you pass environment variables to a container?"><meta property="og:description" content="Programs often control operation through configuration bundled with the software, and environment variables allow users to set them at runtime. However, running processes in Docker containers complicates things, so how do you pass environment variables to a container?"><meta property="twitter:description" content="Programs often control operation through configuration bundled with the software, and environment variables allow users to set them at runtime. However, running processes in Docker containers complicates things, so how do you pass environment variables to a container?"><meta property="twitter:card" content="summary"><meta name=keyword content><link rel="shortcut icon" href=./img/favicon.ico><title>How to Pass Environment Variables to Docker Containers |</title><link rel=canonical href=./how-to-pass-environment-variables-to-docker-containers.html><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/bootstrap.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=https://assets.cdnweb.info/hugo/cleanwhite/css/zanshang.css><link href=https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css rel=stylesheet type=text/css><script src=https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/bootstrap.min.js></script>
<script src=https://assets.cdnweb.info/hugo/cleanwhite/js/hux-blog.min.js></script></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=./>SnapBlog</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=./categories/blog>blog</a></li><li><a href=./sitemap.xml>Sitemap</a></li><li><a href=./index.xml>RSS</a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(/img/home-bg-jeep.jpg)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags></div><h1>How to Pass Environment Variables to Docker Containers</h1><h2 class=subheading></h2><span class=meta>Posted by
Reinaldo Massengill
on
Wednesday, September 11, 2024</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><img src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/csit/2019/06/c454d054.png style=margin:auto;display:block;text-align:center;max-width:100%;height:auto><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>What Are Environment Variables Used For?</a></li></ul><ul class=table-content-level-1><li><a href=#>With a Command Line Argument</a></li></ul><ul class=table-content-level-1><li><a href=#>Additional Security With an .env File</a></li></ul><ul class=table-content-level-1><li><a href=#>With Docker-Compose</a></li></ul><ul class=table-content-level-1><li><a href=#>With Kubernetes</a></li></ul><p>Programs often control operation through configuration bundled with the software, and environment variables allow users to set them at runtime. However, running processes in Docker containers complicates things, so how do you pass environment variables to a container?</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=what-are-environment-variables-used-for>What Are Environment Variables Used For?</h2><p>Environment variables allow you to decouple the configuration from the application's executable.&nbsp;For example, you wouldn't want to store your production database password in your codebase---if you did, it would be visible from Git, and anyone with access to your code could take down your database.</p><p>Instead, you set it with an environment variable, which stores a simple key-value pair, and allows you to access the value in&nbsp;any application running in the same shell session (they're not globally accessible).&nbsp; This also has the benefit of being able to easily define different configuration for different environments. For example, having separate keys for development and production databases, or using a different API endpoint.</p><p>Setting these variables for Docker containers can be done in three main ways---with CLI arguments, <code>.env</code> config files, or through <code>docker-compose</code>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=with-a-command-line-argument>With a Command Line Argument</h2><p>The command used to launch Docker containers, <code>docker run</code>, accepts ENV variables as arguments. Simply run it with the</p><pre><code class=hljs>-e</code> </pre><p>&nbsp;flag, shorthand for</p><pre><code class="hljs sql"><span class=hljs-comment>--env</span></code> </pre><p>, and pass in the key=value pair:</p><pre>sudo docker run  <p>-e POSTGRES_USER='postgres' </p>  <p>-e POSTGRES_PASSWORD='password' </p>  <p>...</p></pre><p>And, if you already have those environment variables set in the environment that is running that command, you can just pass them in directly by name:</p><pre>// set variable  <p>POSTGRES_PASSWORD='password'</p>  <p>// use it later</p>  <p>docker run&nbsp;-e POSTGRES_PASSWORD -e&nbsp;POSTGRES_USER ...</p></pre><h2 id=additional-security-with-an-env-file>Additional Security With an .env File</h2><p>Passing variables with CLI arguments works great, but it has a downside---those variables are visible from the host. They're logged in the command history, and visible in the process listing for the launched process.</p><p>Linux has a built in way to manage permissions for this---file access. Storing the variables in an&nbsp;<code>.env</code> file allows you to control access to that file with file permissions (<code>chmod</code>, <code>chown</code>).</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Create an <code>.env</code>&nbsp;file with variables in the following format, each on a new line:</p><pre>POSTGRES_PASSWORD='password'  <p>POSTGRES_USER='postgres'</p>  <p>APPLICATION_URL='example.com'</p></pre><p>Then, pass it to <code>docker run</code>&nbsp;with the <code>--env-file</code>&nbsp;flag:</p><pre>docker run --env-file ./envfile ...</pre><h2 id=with-docker-compose>With Docker-Compose</h2><p>Of course, many people do not launch Docker containers directly with <code>docker run</code>, and instead opt to use a <code>docker-compose</code>&nbsp;file to handle the configuration of multiple containers all representing a single application.</p><p>To pass environment variables to a container launched this way, you will have to configure the compose file to pass the session's variables through to the Docker container. This configuration here passes the <code>POSTGRES_USER</code>&nbsp;variable to both the build environment and the runtime environment, and sets a default value if it does not exist.</p><pre>version: '3.1'  <p>services:</p>  <p> my-service: </p>  <p> build:</p>  <p> context: .</p>  <p> args:</p>  <p> - POSTGRES_USER=${POSTGRES_USER:-default}</p>   <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong>  <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <p> environment: </p>  <p> - POSTGRES_USER=${POSTGRES_USER:-default}</p></pre><p>You will need to set the environment variables before running <code>docker-compose up</code>, otherwise it will not be able to access them. You could store them in the compose file, but that's usually tracked and versioned, which defeats the purpose of env variables.</p><h2 id=with-kubernetes>With Kubernetes</h2><p>Kubernetes is an orchestration system that can handle running hundreds of containers across a network. It still uses Docker, but you will only ever touch configuration, so passing environment variables directly won't work.</p><p>Instead, you can define them in the configuration for the Pod:</p><pre>apiVersion: v1  <p>kind: Pod</p>  <p>metadata:</p>  <p> name: example</p>  <p>spec:</p>  <p> containers:</p>  <p> - ...</p>  <p> env:</p>  <p> - name: SERVICE_PORT</p>  <p> value: "80"</p>  <p> - name: SERVICE_IP</p>  <p> value: "172.17.0.1"</p></pre><p>Kubernetes is complicated, and there are a lot of different ways to work with environment variables. To learn more, you can <a href=#>read their guides on injecting data into Pods</a>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGibnq6fpcBwtM6wZK2nXaWutL%2BMnqWvoaKku66xza1kr5minq6juMSsZK2nXZm8pLfEq2Scp56prqq6xKuqaA%3D%3D</p><hr><ul class=pager><li class=previous><a href=./jeffrey-epsteins-assistant-lesley-groff-spotted-connecticut-html.html data-toggle=tooltip data-placement=top title="Jeffrey Epstein 'recruiter' Lesley Groff is spotted in Connecticut">&larr;
Previous Post</a></li><li class=next><a href=./autumn-winter-2023-fashion-shows-trends.html data-toggle=tooltip data-placement=top title="Highlights from the autumn/winter 2023 shows">Next
Post &rarr;</a></li></ul></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=./tags/>FEATURED TAGS</a></h5><div class=tags></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"></ul><p class="copyright text-muted">Copyright &copy; SnapBlog 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(i,t){var n=document,s="script",e=n.createElement(s),o=n.getElementsByTagName(s)[0];e.src=i,t&&e.addEventListener("load",function(e){t(null,e)},!1),o.parentNode.insertBefore(e,o)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,r=$(_containerSelector),a=r.find("h1,h2,h3,h4,h5,h6");return $(e).html(''),a.each(function(){n=$(this).prop("tagName").toLowerCase(),i="#"+$(this).prop("id"),s=$(this).text(),t=$('<a href="'+i+'" rel="nofollow">'+s+"</a>"),o=$('<li class="'+n+'_nav"></li>').append(t),$(e).append(o)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("https://assets.cdnweb.info/hugo/cleanwhite/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>